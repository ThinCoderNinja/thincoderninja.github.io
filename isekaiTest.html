<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YDIARWBWRBTGOLAJTHAWYBA - Simulator v9</title> 
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=MedievalSharp&display=swap" rel="stylesheet">
    <!-- Link to the external CSS file -->
    <link rel="stylesheet" href="YDIARWBWRBTGOLAJTHAWYBA_style.css">
</head>
<body>
    <div id="gameContainer" class="game-container">
        <h1 id="gameTitle" class="game-title-header font-bold text-center mb-3 title-font">
            You Died in a Random Way But Was Reborn by the Primordial Goddess of Love and Justice to Help a World Where You're Born Anew
        </h1>
        
        <div id="initialLoadPrompt" class="text-center hidden"></div>
        <div id="occupationSelection" class="text-center hidden"></div>
        <div id="classSelection" class="hidden">
            <h2 id="classSelectionTitle" class="text-xl md:text-2xl mb-3 text-center title-font">The Goddess Offers You a Path...</h2>
            <p id="classSelectionIntro" class="text-center mb-3"></p>
            <div id="classChoicesContainer"></div>
        </div>
        <div id="eventDisplay" class="hidden mt-4">
             <h2 id="eventTitleElem" class="text-xl md:text-2xl mb-2"></h2>
             <p id="eventTextElem" class="mb-3 text-md md:text-lg"></p>
             <button id="continueButtonElem" class="btn btn-primary mx-auto block">Continue</button>
        </div>
        <div id="gameOverScreen" class="hidden mt-4">
            <h2 class="text-3xl title-font mb-4">Game Over</h2>
            <p id="finalDeathMessage" class="text-lg mb-6"></p>
            <div class="flex justify-center gap-4">
                <button id="newGameFromDeathButton" class="btn btn-primary">Start New Life</button>
                <button id="viewPastDeathsFromDeathButton" class="btn btn-info">View Past Deaths</button>
            </div>
        </div>

        <div id="newLifeInterface" class="hidden mt-4">
            <div class="grid md:grid-cols-3 gap-3">
                <div id="characterSheet" class="md:col-span-1 bg-gray-700 p-2 rounded overflow-y-auto max-h-[90vh]">
                    <h3 class="text-md font-semibold mb-1 title-font">Character Sheet</h3>
                    <div id="charDate"></div>
                    <div id="charName"></div>
                    <div id="charAge"></div>
                    <div id="charGold"></div> 
                    <div id="charWorld"></div>
                    <div id="charRank"></div>
                    <div id="charPowerScore"></div> 
                    <div id="charHP"></div>
                    <div id="charStamina"></div> 
                    <div id="charRankXP"></div>
                    <div id="charClass"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Elemental Spirit:</h4>
                    <div id="charElementalSpirit"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Companions:</h4>
                    <div id="charCompanionsList"></div> 
                    <div id="charChildren"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Stats (Base):</h4>
                    <div id="charBaseStats"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Effective Stats:</h4>
                    <div id="charEffectiveStats"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Accolades:</h4>
                    <div id="charAccolades"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Titles:</h4>
                    <div id="charTitles"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Equipment:</h4>
                    <div id="charEquipment"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Treasures:</h4>
                    <div id="charTreasures"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Blessings:</h4>
                    <div id="charBlessings"></div>
                    <h4 class="text-sm font-semibold mt-1 mb-0.5 title-font">Curses:</h4>
                    <div id="charCurses"></div>
                </div>

                <div class="md:col-span-2">
                    <div id="worldActionsContainer">
                         <h3 class="text-md font-semibold mb-1 title-font">World Actions:</h3>
                         <div id="actionsContainer" class="action-button-container mb-2"></div>
                         <button id="viewPastDeathsButtonUI" class="btn btn-deaths w-full mb-2 hidden">View Past Deaths</button>
                         <button id="saveGameButtonUI" class="btn btn-save w-full mb-2">Save Game</button>
                         <button id="itemBagButtonUI" class="btn btn-bag w-full mb-2">Item Bag</button>
                         <button id="manageCompanionsButtonUI" class="btn btn-manage-social w-full mb-2">Manage Companions</button>
                         <button id="advanceYearButtonUI" class="btn btn-primary w-full mb-2">Sleep till Next Year</button>
                    </div>
                    <div id="dungeonInterface" class="hidden">
                         <h3 id="dungeonName" class="text-md font-semibold mb-1 title-font"></h3>
                         <div id="dungeonStatus"></div>
                         <div id="dungeonActionsContainer" class="action-button-container mt-1">
                             <button id="dungeonExploreButton" class="btn btn-dungeon">Explore Deeper</button>
                             <button id="dungeonRestButton" class="btn btn-info">Rest (1 Turn)</button>
                             <button id="dungeonFleeButton" class="btn btn-danger">Flee Dungeon</button>
                         </div>
                    </div>
                    <h3 class="text-md font-semibold mt-2 mb-1 title-font">Event Log:</h3>
                    <div id="eventLog" class="bg-gray-700 p-2 rounded max-h-40 overflow-y-auto text-xs"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="messageModal" class="modal hidden">...</div>
    <div id="elementalSpiritModal" class="modal hidden">...</div>
    <div id="itemBagModal" class="modal hidden">...</div>
    <div id="shopModal" class="modal hidden">...</div>
    <div id="manageCompanionsModal" class="modal hidden">...</div>
    <div id="deathMessagesModal" class="modal hidden">...</div>
    <div id="guildHallModal" class="modal hidden">...</div>

    <!-- Modular JavaScript Files -->
    <!-- The order is important due to dependencies -->
    <script src="YDIARWBWRBTGOLAJTHAWYBA_gameData.js"></script>
    <script src="YDIARWBWRBTGOLAJTHAWYBA_itemSystem.js"></script>
    <script src="YDIARWBWRBTGOLAJTHAWYBA_uiManager.js"></script>
    <script src="YDIARWBWRBTGOLAJTHAWYBA_actionHandler.js"></script>
    <script src="YDIARWBWRBTGOLAJTHAWYBA_gameManager.js"></script>
    
    <!-- Main entry point script -->
    <script src="YDIARWBWRBTGOLAJTHAWYBA_main.js"></script>
</body>
</html>
```

***

### 2. CSS Stylesheet

All styles have been moved to this external file.


```css
body { font-family: 'Inter', sans-serif; background-color: #1a202c; color: #e2e8f0; }
.game-container { max-width: 1100px; margin: 0.5rem auto; padding: 1rem; background-color: #2d3748; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05); }
.btn { padding: 0.5rem 0.8rem; border-radius: 0.375rem; font-weight: 600; transition: background-color 0.2s ease-in-out; cursor: pointer; border: none; font-size: 0.8rem; }
.btn-primary { background-color: #4a5568; color: #e2e8f0; }
.btn-primary:hover { background-color: #2c5282; }
.btn-action, .btn-romance, .btn-world, .btn-age-specific { background-color: #38a169; color: white; }
.btn-action:hover, .btn-romance:hover, .btn-world:hover, .btn-age-specific:hover { background-color: #2f855a; }
.btn-world { background-color: #d69e2e; } 
.btn-world:hover { background-color: #b08026; }
.btn-danger { background-color: #c53030; color: white; }
.btn-danger:hover { background-color: #9b2c2c; }
.btn-info { background-color: #3182ce; color: white; }
.btn-info:hover { background-color: #2b6cb0; }
.btn-battle { background-color: #97266d; color: white; }
.btn-battle:hover { background-color: #702459; }
.btn-dungeon { background-color: #dd6b20; color: white; } 
.btn-dungeon:hover { background-color: #c05621; }
.btn-save { background-color: #b7791f; color: white; } 
.btn-save:hover { background-color: #975a16; }
.btn-bag { background-color: #63b3ed; color: white; } 
.btn-bag:hover { background-color: #4299e1; }
.btn-tavern { background-color: #a0aec0; color: #1a202c; }
.btn-tavern:hover { background-color: #718096; }
.btn-shop { background-color: #ecc94b; color: #1a202c; }
.btn-shop:hover { background-color: #d69e2e; }
.btn-confess { background-color: #d53f8c; color: white; } 
.btn-confess:hover { background-color: #b83280; }
.btn-sell { background-color: #e53e3e; color: white; }
.btn-sell:hover { background-color: #c53030; }
.btn-manage-social { background-color: #4299e1; color:white;}
.btn-manage-social:hover { background-color: #2b6cb0;}
.btn-deaths { background-color: #718096; color: white; }
.btn-deaths:hover { background-color: #4a5568;}
.btn-guild { background-color: #6b46c1; color: white;}
.btn-guild:hover { background-color: #553c9a;}


.character-sheet div, .log-entry { padding: 0.15rem 0.3rem; border-bottom: 1px solid #4a5568; font-size: 0.78rem; }
.character-sheet div:last-child, .log-entry:last-child { border-bottom: none; }
.title-font { font-family: 'MedievalSharp', cursive; }
.game-title-header { font-size: 1.1rem; line-height: 1.2; }
@media (min-width: 640px) { .game-title-header { font-size: 1.3rem; } }
@media (min-width: 1024px) { .game-title-header { font-size: 1.5rem; } }
.modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.8); display: flex; justify-content: center; align-items: center; z-index: 100; padding: 1rem; }
.modal-content { background-color: #2d3748; padding: 1.5rem; border-radius: 0.5rem; text-align: center; max-width: 90%; width: 500px; border: 2px solid #4a5568; } 
.hidden { display: none !important; }
.action-button-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(190px, 1fr)); gap: 0.3rem; }
.progress-bar-container { width: 100%; background-color: #4a5568; border-radius: 0.25rem; overflow: hidden; height: 0.8rem; margin-top: 0.15rem; }
.progress-bar { height: 100%; text-align: center; line-height: 0.8rem; color: white; font-size: 0.65rem; transition: width 0.3s ease-in-out; }
.hp-bar { background-color: #c53030; } 
.xp-bar { background-color: #3182ce; } 
.power-bar { background-color: #f6e05e; color: #1a202c !important; } 
.stamina-bar { background-color: #48bb78; } 
.relationship-bar { background-color: #d53f8c; } 
.dungeon-time-bar { background-color: #dd6b20; }
.stat-value { font-weight: bold; color: #a0aec0; }
.item-name { color: #63b3ed; } 
.item-stat-summary { font-size: 0.7rem; color: #90cdf4; margin-left: 4px; }
.item-effect { color: #9f7aea; }
.accolade-name, .title-name, .blessing-name, .curse-name { color: #f6e05e; cursor: pointer; text-decoration: underline; } 
.accolade-name:hover, .title-name:hover, .blessing-name:hover, .curse-name:hover { color: #faf089; }
.gold-value { color: #f6e05e; font-weight: bold;}
.class-choice-card { background-color: #4a5568; padding: 0.8rem; border-radius: 0.375rem; margin-bottom: 0.5rem; cursor: pointer; }
.class-choice-card:hover { background-color: #2c5282; }
.class-choice-card h4 { font-size: 1em; margin-bottom: 0.2em; }
.class-choice-card p { font-size: 0.8em; margin-bottom: 0.1em; }
.character-sheet h4 { font-size: 0.85em; margin-top: 0.5rem; }

#itemBagModal .item-slot, #shopModal .shop-item-slot, #sellInterface .sell-item-slot, #manageCompanionsModal .companion-manage-slot, #deathMessagesModal .death-message-entry, #guildHallModal .quest-entry {
    background-color: #3f4a5a;
    padding: 0.5rem;
    margin-bottom: 0.5rem;
    border-radius: 0.25rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: relative; 
}
#deathMessagesModal .death-message-entry, #guildHallModal .quest-entry {
    display: block; 
    text-align: left;
}
#guildHallModal .quest-entry button { margin-top: 0.5rem; }

#itemBagModal .item-slot .item-name-container, 
#shopModal .shop-item-slot .item-name-container, 
#sellInterface .sell-item-slot .item-name-container,
#manageCompanionsModal .companion-manage-slot .companion-name-container {
    flex-grow: 1;
    text-align: left;
}

#itemBagModal .item-slot .item-name, #shopModal .shop-item-slot .item-name, #sellInterface .sell-item-slot .item-name, #manageCompanionsModal .companion-manage-slot .companion-name {
    font-weight: bold;
    color: #63b3ed;
}
#manageCompanionsModal .companion-manage-slot .btn { /* Specific styling for buttons in this modal */
     margin-left: 0.25rem;
     padding: 0.2rem 0.4rem;
     font-size: 0.7rem;
}

#itemBagModal .item-slot .btn-equip, #shopModal .shop-item-slot .btn-buy, #sellInterface .sell-item-slot .btn-sell, #manageCompanionsModal .companion-manage-slot .btn-part-ways {
    background-color: #38a169;
    color: white;
    margin-left: 0.5rem;
    padding: 0.3rem 0.6rem;
    font-size: 0.75rem;
}
#sellInterface .sell-item-slot .btn-sell, #manageCompanionsModal .companion-manage-slot .btn-part-ways { background-color: #e53e3e; }
#sellInterface .sell-item-slot .btn-sell:hover, #manageCompanionsModal .companion-manage-slot .btn-part-ways:hover { background-color: #c53030; }
#itemBagModal .item-slot .btn-equip:hover, #shopModal .shop-item-slot .btn-buy:hover {
    background-color: #2f855a;
}
.item-tooltip {
    position: absolute;
    background-color: #1a202c;
    border: 1px solid #4a5568;
    padding: 0.5rem;
    border-radius: 0.25rem;
    font-size: 0.75rem;
    z-index: 101; 
    bottom: 100%; 
    left: 50%;
    transform: translateX(-50%);
    white-space: nowrap;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
    margin-bottom: 5px; 
    pointer-events: none; 
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
}
.item-slot:hover .item-tooltip, .shop-item-slot:hover .item-tooltip, .sell-item-slot:hover .item-tooltip { 
    opacity: 1;
}
 #shopModal .shop-item-cost, #sellInterface .sell-item-price {
    color: #f6e05e; 
    margin-left: 0.5rem;
    font-size: 0.8rem;
}
#charCompanionsList .companion-entry {
    padding: 0.25rem 0;
    border-bottom: 1px solid #3a4150;
}
#charCompanionsList .companion-entry:last-child {
    border-bottom: none;
}
#charCompanionsList .companion-name {
    font-weight: 600;
    color: #90cdf4; 
}
#charCompanionsList .companion-type {
    font-style: italic;
    color: #a0aec0;
}
.shop-tabs {
    display: flex;
    margin-bottom: 1rem;
    border-bottom: 1px solid #4a5568;
}
.shop-tab {
    padding: 0.5rem 1rem;
    cursor: pointer;
    border-bottom: 2px solid transparent;
}
.shop-tab.active {
    border-bottom-color: #ecc94b;
    color: #ecc94b;
    font-weight: bold;
}
#gameOverScreen {
    background-color: #2d3748;
    padding: 2rem;
    border-radius: 0.5rem;
    text-align: center;
    border: 2px solid #c53030;
}
#gameOverScreen h2 {
    color: #c53030;
}
